# Идеи на будущее: чего ещё нет в приложении

То, что **не собираем**, **не анализируем** и **не показываем** сейчас — кандидаты для следующих итераций.

---

## 1. Данные, которые пока не собираем

- **Сессия краула как сущность:** `startedAt`, `finishedAt`, длительность, `startUrl`, снимок опций (maxDepth, maxPages, delay). Сейчас есть только текущий run в памяти — нет «запуска» как записи для истории.
- **Глубина и родитель:** для каждого URL — уровень глубины (0, 1, 2…) и URL страницы, с которой пришли (parent). Сейчас в `CrawlPageData` этого нет — нельзя строить дерево и «кто кого нашёл».
- **Цепочка редиректов:** начальный URL → финальный URL, список 301/302. Сейчас только финальный URL и, возможно, statusCode — нет полной цепочки.
- **Заголовки ответа:** Cache-Control, ETag, Content-Type, X-Robots-Tag. Не сохраняем — нельзя анализировать кеш.
- **Размер ответа:** размер HTML (bytes). В `contentLength` может быть — если нет, добавить; нужно для «тяжёлые страницы».
- **Время до первого байта (TTFB):** если замерять в краулере — можно показывать «медленные по TTFB».
- **Хеш контента (body hash):** для поиска дублей контента и «почти одинаковых» страниц.
- **Внешние ссылки отдельно:** сколько ссылок уходит наружу с каждой страницы — internal/external.
- **Сироты:** страницы, на которые никто не ссылается из того же сайта. Нужен граф ссылок (кто на кого ссылается).
- **Битые исходящие ссылки:** куда ведёт ссылка и какой у цели statusCode (404, 5xx). Сейчас смотрим только саму страницу — не «куда она ссылается».

---

## 2. Анализ, который пока не делаем

- **История сеансов:** список краулов (дата, длительность, кол-во страниц, стартовый URL) — для сравнения «было 180 страниц, стало 210». Требует сохранять сессии (БД/проекты).
- **Сравнение двух краулов:** один и тот же startUrl, два запуска — «появились URL», «исчезли URL», «изменился statusCode». Нужны сохранённые сессии и привязка к проекту.
- **Тренды:** «за последние 5 краулов — рост числа страниц / падение ошибок». На основе истории сеансов.
- **Топ медленных страниц:** по `loadTimeMs` (и при желании TTFB). Данные могут быть, но отдельного отчёта/вью нет.
- **Топ страниц по числу ссылок:** исходящих и/или входящих (входящие — из графа внутренних ссылок).
- **Сироты и «глухие» страницы:** на них никто не ссылается — отдельный список и отчёт.
- **Дубликаты контента:** по хешу тела или по нормализованному тексту — «эти страницы почти одинаковые».
- **SEO-чеклист:** нет title, нет h1, дубликаты title/h1, нет meta description, длинные title. Считается по уже собранным полям, но отдельного агрегированного отчёта нет.
- **Расхождение с sitemap:** URL есть в sitemap, но не попал в краул (или наоборот). Нужны sitemap URL и результат краула — сравнение.
- **Граф внутренних ссылок:** кто на кого ссылается — для визуализации и поиска «важных» страниц (много входящих).
- **Цепочки редиректов:** карта «страница A → 301 → B → 302 → C» — отдельный отчёт.
- **Внешние домены:** куда уходят ссылки с сайта (топ доменов) — по разметке internal/external.

---

## 3. Что можно сделать и показать (чего ещё нет)

- **История краулов по проекту:** список сеансов (дата, длительность, страниц, стартовый URL) — переход к результату конкретного краула, сравнение с предыдущим. Требует: сохранять сессии в БД при завершении краула.
- **Сравнение двух сеансов:** выбор «краул A» и «краул B» → дифф: новые URL, пропавшие URL, изменившийся статус/заголовок. На основе сохранённых сессий.
- **Графики трендов:** по сохранённым сеансам — «страниц за последние N краулов», «ошибок за последние N краулов», длительность. Не дашборд текущих метрик, а «как менялось со временем».
- **Отчёт «сироты»:** страницы без входящих внутренних ссылок — таблица + при желании экспорт.
- **Отчёт «битые исходящие»:** ссылки, ведущие на 404/5xx — по странице и по URL цели. Требует: при крауле или отдельным проходом проверять целевые URL.
- **Отчёт редиректов:** цепочки 301/302 с визуализацией «откуда → куда». Требует: сохранять цепочку при запросе.
- **Отчёт дубликатов контента:** группы страниц с одинаковым/похожим контентом (по хешу или тексту). Требует: считать и хранить хеш.
- **SEO-отчёт:** агрегат по всем страницам: нет title, нет h1, дубли title/h1, нет meta description — список страниц по каждому пункту.
- **Diff sitemap vs краул:** «в sitemap, но не обошли» / «обошли, но не в sitemap». Уже есть sitemap и список URL краула — нужен только экран сравнения.
- **Визуализация графа ссылок:** граф «страница → страница» (внутренние ссылки). Требует: хранить «кто на кого ссылается» (родитель + все исходящие).
- **Напоминания/алерты:** «последний краул этого сайта был 7 дней назад», «в последнем крауле +20 404» (при наличии истории и базовой линии).
- **Планировщик краулов:** «каждый день в 8:00 краулить этот URL» — потом те же сравнения и тренды по сохранённым сеансам.
- **Экспорт не только URL:** экспорт в CSV/SQLite/JSON с полями (url, title, h1, statusCode, loadTimeMs, depth, parent…) для анализа в других инструментах.
- **Снимок страницы (screenshot):** при обходе сохранять миниатюру — потом «галерея страниц» или визуальный дифф. Требует: делать скриншот в краулере и хранить путь/бинар.

---

## 4. Приоритеты «чего ещё нет»

| Идея | Что не собираем/не храним | Что нужно добавить |
|------|---------------------------|---------------------|
| История сеансов, сравнение, тренды | Сессия как запись (дата, длительность, страниц, startUrl, опции) | Сохранять сессию в БД при завершении краула; вью «История» и «Сравнение» |
| Глубина, дерево, граф ссылок | depth, parent URL, «кто на кого ссылается» | Считать при крауле и писать в БД/память |
| Сироты, битые исходящие | Входящие ссылки, проверка целевых URL | Граф ссылок; опционально второй проход по внешним ссылкам |
| Редиректы, дубликаты контента | Цепочка редиректов, хеш тела | Собирать в краулере и сохранять |
| SEO-отчёт, diff sitemap | Частично есть | Агрегация + отдельные экраны/отчёты |
| Тренды, алерты, планировщик | История сеансов | БД сессий + UI |

**Базовый шаг:** сессия краула как сохраняемая сущность (дата, длительность, кол-во страниц, startUrl, опции) и на её основе история сеансов + сравнение двух краулов. Остальное — следующий уровень (глубина, родитель, редиректы, хеши, граф ссылок) и поверх них отчёты и визуализации.
